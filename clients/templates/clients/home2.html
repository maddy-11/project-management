{% extends 'clients/base.html' %}

{% block title %}Dashboard - FineBooks{% endblock %}

{% block content %}
      {% if request.path == '/' and 'dashboard' in user.role.page_access %}
      <div class="alert alert-light d-flex align-items-center mb-4 shadow-sm rounded-3">
        <div class="d-flex align-items-center">
          <i class="fa fa-hand-peace fs-3 me-3"></i>
          <div>
            <h4 class="mb-0">Welcome, {{ user.first_name|default:user.username }}!</h4>
            <small class="text-muted">Glad to see you on your dashboard.</small>
          </div>
        </div>
      </div>
      <!-- Dashboard Cards -->
      <div class="row g-4 mb-4">
        <div class="col-md-3">
          <div class="card p-4 shadow-sm border-1">
            <h5 class="mb-2"><i class="fa-solid fa-money-bill-wave me-2 text-danger"></i> Total Expenses</h5>
            <p class="fs-4 fw-bold">{{ budget.currency|default:'USD' }} {{ total_expenses_with_salaries|floatformat:2 }}</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card p-4 shadow-sm border-1">
            <h5 class="mb-2"><i class="fa-solid fa-scale-balanced me-2 text-warning"></i> Difference</h5>
            <p class="fs-4 fw-bold {% if difference < 0 %}text-danger{% else %}text-success{% endif %}">
              {{ budget.currency|default:'USD' }} {{ difference|floatformat:2 }}
            </p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card p-4 shadow-sm border-1">
            <h5 class="mb-2"><i class="fa-solid fa-users me-2 text-primary"></i> Employees</h5>
            <p class="fs-4 fw-bold">{{ employee_count }}</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card p-4 shadow-sm border-1">
            <h5 class="mb-2"><i class="fa-solid fa-user-tie me-2 text-secondary"></i> Total Salaries</h5>
            <p class="fs-4 fw-bold">{{ budget.currency|default:'USD' }} {{ total_salaries|floatformat:2 }}</p>
          </div>
        </div>
      </div>
      <!-- Recent Expenses Table -->
      <div class="card p-4 shadow-sm border-0">
        <h5 class="mb-3"><i class="fa-solid fa-clock-rotate-left me-2"></i> Recent Expenses</h5>
        <div class="table-responsive">
          <table class="table table-bordered table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th>Name</th>
                <th>Amount</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              {% for expense in recent_expenses %}
              <tr>
                <td>{{ expense.name }}</td>
                <td>{{ expense.amount }}</td>
                <td>{{ expense.date }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="4" class="text-center text-muted">No recent expenses.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      {% endif %}
{% endblock %} 
